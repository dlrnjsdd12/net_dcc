Abstract. 

네트워크 침입 탐지 시스템(NIDS)은 점점 더 빈번해지고 정교한 사이버 공격으로부터 컴퓨터 네트워크를 보호하는 중요한 도구입니다. 최근 기계 학습(ML) 기반의 NIDS 개발에 많은 연구가 이루어지고 있습니다. 모든 ML 기반 애플리케이션과 마찬가지로 고품질 데이터 세트의 가용성은 ML 기반 NIDS의 교육 및 평가에 매우 중요합니다. 현재 사용 가능한 NIDS 데이터 세트의 주요 문제 중 하나는 표준 기능 세트가 없다는 것입니다. 공개적으로 사용 가능한 각 데이터 세트에 대해 고유하고 독점적인 기능 세트를 사용하면 서로 다른 데이터 세트에서 ML 기반 트래픽 분류기의 성능을 비교하고 따라서 이러한 시스템이 서로 다른 네트워크 시나리오에서 일반화하는 기능을 평가하는 것이 사실상 불가능합니다. . 이러한 한계를 해결하기 위해 이 백서는 NetFlow 네트워크 메타 데이터 수집 프로토콜 및 시스템을 기반으로 하는 표준 NIDS 기능 세트를 제안하고 평가합니다. 두 가지 NetFlow 기반 기능 세트 변형, 즉 12개 기능이 포함된 버전과 43개 기능이 포함된 다른 버전을 평가하고 비교합니다. 평가를 위해 널리 사용되는 4개의 NIDS 데이터 세트(UNSW-NB15, BoT-IoT, ToN-IoT, CSE-CIC-IDS2018)를 제안된 NetFlow 기반 기능 세트가 있는 새로운 변형으로 변환했습니다. Extra Tree 분류기를 기반으로 NetFlow 기반 기능 세트의 분류 성능을 원본 데이터 세트와 함께 제공되는 독점 기능 세트와 비교했습니다. 더 작은 기능 세트는 독점 기능 세트의 분류 성능과 일치할 수 없지만 43개의 NetFlow 기능이 포함된 더 큰 세트는 놀랍게도 각 NIDS 데이터 세트에 맞게 조정된 원래 기능 세트에 비해 지속적으로 더 높은 분류 성능을 달성합니다. 연구 커뮤니티에서 사용할 수 있는 4개의 벤치마크 데이터 세트와 함께 제안된 NetFlow 기반 표준 NIDS 기능 세트를 통해 다양한 NIDS 데이터 세트에서 ML 기반 네트워크 트래픽 분류자를 공정하게 비교할 수 있습니다. 우리는 표준 기능 세트를 갖는 것이 ML 기반 NIDS를 보다 엄격하고 철저하게 평가할 수 있도록 하는 데 중요하며 학술 연구와 그러한 시스템의 실제 배포 사이의 격차를 해소하는 데 도움이 될 수 있다고 믿습니다.

Index terms— Machine Learning, NetFlow, Network Intrusion Detection System

1 Introduction
NIDS(Network Intrusion Detection System)는 네트워크 공격을 감지하고 정보 보안의 세 가지 원칙인 기밀성, 무결성 및 가용성을 유지하는 것을 목표로 합니다[1]. 서명 기반 NIDS는 공격 서명을 관찰된 트래픽과 일치시켜 알려진 공격에 대해 높은 탐지 정확도를 제공합니다. 그러나 이러한 시스템은 이전에 발견되지 않은(제로데이) 공격이나 알려진 공격의 새로운 변종을 탐지할 수 없습니다. 따라서 연구원들은 공격 행동과 패턴의 일치에 초점을 맞춘 이상 기반 NIDS를 조사했습니다[2]. 인공 지능의 하위 분야인 기계 학습(ML)은 탐지되지 않을 경우 컴퓨터 네트워크를 위협할 수 있는 복잡한 네트워크 공격 패턴을 학습하고 추출할 수 있습니다[3]. 모든 네트워크 침입 gen-arXiv:2101.11315v2 [cs.NI] 2021년 5월 15일 분류 프로세스에 도움이 되는 고유한 보안 이벤트 세트를 평가합니다. 이러한 식별 패턴은 데이터 기능의 형태로 네트워크 트래픽에서 추출할 수 있습니다. 데이터 세트를 생성하기 위해 해당 데이터 기능은 감독된 ML 방법론을 허용하기 위해 이상적으로 공격 또는 양성 클래스로 레이블이 지정된 네트워크 데이터 흐름을 형성합니다.

공격 및 무해한 흐름을 식별하는 레이블이 있는 실제 네트워크 흐름 데이터 세트는 주로 보안 및 개인 정보 보호 문제로 인해 얻기가 어렵습니다. 따라서 연구원들은 레이블이 지정된 네트워크 데이터 흐름으로 구성된 합성 데이터 세트를 생성하기 위해 네트워크 테스트 베드를 설계했습니다[4]. 데이터 흐름은 작성자의 도메인 지식과 사용 가능한 추출 도구를 기반으로 사전 선택된 여러 네트워크 기능으로 구성됩니다. 결과적으로 현재 사용 가능한 NIDS 데이터 세트는 기능 세트와 데이터 흐름에 의해 표현되는 보안 이벤트 측면에서 매우 다릅니다. ML 모델[5]의 성능에 대한 데이터 기능의 큰 영향으로 인해 제안된 ML 기반 NIDS의 평가는 원래 기능 세트를 사용하여 여러 데이터 세트에서 테스트할 때 종종 신뢰할 수 없습니다. 마지막으로 특정 네트워크 데이터 기능으로

복잡하고 심층적인 패킷 검사가 필요하고 기능 추출 및 처리의 계산 복잡성이 실현 가능하지 않습니다. 모든 데이터 세트에 대한 표준 기능 세트를 갖는 것의 중요성이 가장 중요합니다. 다양한 네트워크 환경과 공격 시나리오에서 제안된 ML 모델을 공정하고 신뢰할 수 있게 평가할 수 있습니다. 이를 통해 모델의 일반화 가능성을 평가할 수 있으므로 실제 네트워크 시나리오에 배포할 때의 성능을 평가할 수 있습니다. 또한 표준 기능 세트는 NIDS 데이터 세트가 제공하는 보안 이벤트 및 네트워크 정보가 동일하고 제어된 방식으로 유지되도록 합니다. NetFlow는 네트워크 트래픽 수집을 위한 업계 표준 프로토콜[6]입니다. NetFlow의 실용적이고 확장 가능한 배포 속성은 ML 기반 NIDS의 배포 가능성을 향상시킬 수 있습니다. NetFlow 기능은 네트워크 공격 식별에 중요한 주요 보안 이벤트를 제공할 수 있습니다. 따라서 범용 기능 세트 설계에 NetFlow 기반 기능을 적용하면 실제 네트워크 시나리오에서 ML 기반 NIDS를 성공적으로 배포할 수 있을 것이라고 믿습니다.

UNSW-NB15[7], BoT-IoT[8], ToN-IoT[9] 및 CIC-CSE-IDS2018[10]이라고 하는 널리 사용되는 4개의 NIDS 데이터 세트가 공통 기본 NetFlow 기반 기능으로 변환되었습니다. 설정 [11]. NetFlow 데이터 세트는 여러 데이터 세트에 공통 기능 세트를 적용하여 현재 연구 문제 중 일부를 해결합니다. 그러나 기본 NetFlow 기능 세트로 표시되는 보안 정보가 충분하지 않기 때문에 ML 모델은 특히 다중 클래스 실험을 수행할 때 감지 정확도가 제한됩니다.

따라서 본 논문에서는 향후 NIDS 데이터셋에서 사용할 표준 버전으로 확장된 NetFlow 기능 세트를 제안한다. 평가의 일환으로 잘 알려진 4개의 데이터 세트에서 기능을 추출하고 레이블을 지정했습니다. 생성된 데이터 세트의 이름은 NF-UNSW-NB15-v2, NF-BoT-IoT-v2, NF-ToN-IoT-v2, NF-CSE-CIC-IDS2018-v2 및 NF-UQ-NIDS-v2이며 연구 목적으로 공개적으로 사용 가능하게 되었습니다[12]. 이 백서에서는 독점 기능 세트와 함께 NetFlow 기반 기능 세트의 두 가지 변형을 살펴봅니다.

나머지 논문은 다음과 같이 구성된다. 기존 NIDS 데이터 세트와 그 제한 사항은 섹션 2에서 설명합니다. 섹션 3은 NIDS 데이터 세트에서 표준 및 공통 기능 세트를 갖는 경우에 동기를 부여합니다. 또한 제안된 기능을 추출하는 방법론을 설명합니다. 마지막으로 섹션 4에서는 추가 트리 분류기를 사용하여 제안된 NetFlow 기반 기능 세트의 예측력을 원본 벤치마크 NIDS 데이터 세트와 함께 제공되는 독점 기능 세트와 비교합니다. 마지막으로 5장에서 논문을 맺는다.

2 Limitations of Existing Datasets

연구원들은 레이블이 지정된 실제 네트워크 트래픽을 얻는 것이 복잡하기 때문에 엔지니어링된 벤치마크 NIDS 데이터 세트를 만들었습니다. 네트워크 테스트베드는 여러 끝 노드의 네트워크 동작을 시뮬레이션하도록 설계되었습니다. 인공 네트워크 환경은 실제 네트워크가 직면한 보안 및 개인 정보 보호 문제를 극복합니다. 게다가, 그러한 통제된 환경에 의해 생성된 네트워크 흐름에 레이블을 지정하는 것이 현실적인 네트워크의 개방형 특성보다 더 안정적입니다. 실험 중에는 무해한 네트워크 트래픽과 다양한 공격 시나리오가 생성되어 네트워크 테스트베드에서 수행됩니다. 그 동안 네트워크 패킷은 기본 패킷 캡처(pcap) 형식으로 캡처되어 저장 장치에 덤프됩니다. 적절한 도구와 방법을 사용하여 pcap 파일에서 일련의 네트워크 데이터 기능을 추출하여 네트워크 데이터 흐름을 형성합니다. 그 결과 양성 및 악성 네트워크 동작을 반영하는 레이블이 지정된 네트워크 흐름의 데이터 소스가 생성됩니다. 생성된 데이터 세트는 게시되고 ML 기반 NIDS 모델의 설계 및 평가 단계에서 사용할 수 있도록 공개적으로 액세스할 수 있습니다[13].

이러한 데이터 흐름을 형성하는 네트워크 데이터 기능은 ML 모델의 양성 및 공격 클래스 분류에 도움이 되는 적절한 양의 보안 이벤트를 나타내야 하므로 매우 중요합니다. 또한 확장 가능하고 실용적인 배포를 위해 개수 및 추출의 복잡성이 실현 가능해야 합니다. ML 기반 NIDS 설계의 핵심 작업은 활용된 데이터 기능을 선택하는 것입니다. 그러나 NIDS 데이터 세트 생성에 대한 표준 기능 세트가 없기 때문에 저자는 이러한 기능 선택에 자신의 도메인 경험을 적용했습니다. 결과적으로 사용 가능한 각 데이터 세트는 작성자가 분류 단계에서 가능한 최상의 결과를 가져올 것이라고 믿는 고유한 기능 세트로 구성됩니다. 현재의 각 기능 세트는 거의 배타적이며 다른 세트와 완전히 다르며 적은 수의 기능만 공유합니다. 여러 데이터 세트에서 ML 모델의 현재 평가 방법은 각 데이터 세트에서 제공하는 고유한 기능 세트를 사용해야 합니다.

각 데이터 세트의 기능 세트가 나타내는 보안 정보의 차이로 인해 평가 방법의 신뢰성에 대한 제한과 우려가 발생했습니다. 표준 기능 세트가 없는 세 가지 주요 문제는 다음과 같습니다. 1. 네트워크 트래픽에서 여러 기능을 복잡하게 추출합니다. 그 중 일부는 보안 이벤트가 없기 때문에 관련이 없습니다. 2. 여러 데이터 세트에서 대상 기능 세트에 대한 ML 모델의 일반화를 평가하는 제한된 기능 및 3. 범용 데이터 세트의 부족 여러 네트워크 환경에서 수집된 네트워크 데이터 흐름을 포함합니다. 신뢰할 수 있는 평가 방법의 부족으로 인해 생산된 광범위한 학술 연구와 생산 네트워크에서 ML 기반 NIDS 모델의 실제 배포 사이에 격차가 발생했다고 믿어집니다[14]. 생산 시간으로 인한 최신 행동 네트워크 공격을 나타내는 가장 최근에 널리 사용되는 4개의 NIDS 데이터 세트에 대해 설명합니다.

• UNSW-NB15 호주 사이버 보안 센터(ACCS)의 Cyber ​​Range Lab은 2015년에 널리 사용되는 UNSW-NB15 데이터 세트를 발표했습니다. IXIA PerfectStorm 도구는 테스트베드 기반 양성 네트워크 활동의 하이브리드 생성에도 활용되었습니다. 합성 공격 시나리오로. tcpdump 도구는 총 100GB의 pcap 파일을 캡처하도록 구현되었습니다. 현재 Zeek[15]라고 불리는 Argus 및 Bro-IDS와 12개의 추가 SQL 알고리즘을 사용하여 데이터 세트의 원래 49개 특징[7]을 추출했습니다. 데이터 세트에는 2,218,761(87.35%)의 양성 흐름과 321,283(12.65%)의 공격 흐름, 즉 총 2,540,044개의 흐름이 포함되어 있습니다.

• BoT-IoT 호주 사이버 보안 센터(ACCS)의 Cyber ​​Range Lab은 2018년에 일반 트래픽과 봇넷 트래픽으로 구성된 네트워크 환경을 설계했습니다[8]. Ostinato 및 Node-red 도구는 각각 비 IoT 및 IoT 트래픽을 생성하는 데 사용되었습니다. 총 69.3GB의 pcap 파일이 캡처되었고 Argus 도구를 사용하여 데이터 세트의 원래 42개 특징을 추출했습니다. 데이터 세트에는 477개(0.01%)의 양성 흐름과 3,668,045개(99.99%)의 공격 흐름, 즉 총 3,668,522개의 흐름이 포함되어 있습니다.

• ToN-IoT 2019년에 발표된 최근 이기종 데이터 세트[9]에는 사물 인터넷(IoT) 서비스의 원격 측정 데이터, IoT 네트워크의 네트워크 트래픽 및 운영 체제 로그가 포함됩니다. 본 논문에서는 네트워크 트래픽 흐름을 포함하는 부분을 활용한다. 데이터 세트는 ACCS의 Cyber ​​Range Lab에서 현실적인 대규모 네트워크를 표현하여 수행된 많은 수의 공격 시나리오로 구성됩니다. 현재 Zeek[15]라고 불리는 Bro-IDS는 데이터 세트의 원래 44개 특징을 추출하는 데 사용되었습니다. 데이터 세트는 796,380(3.56%)의 양성 흐름과 21,542,641(96.44%)의 공격 샘플, 즉 총 22,339,021개의 흐름으로 구성됩니다.

• CSE-CIC-IDS2018 CSE(Communications Security Establishment) 간의 협업 프로젝트에서 공개한 데이터 세트
그림 1에는 앞서 언급한 데이터 세트의 공유 및 고유 기능이 표시됩니다. 4개의 데이터 세트 모두에서 사용할 수 있는 기능 세트에는 3개의 기능이 포함되어 있으며 쌍별 공유 기능 번호는 1에서 5까지 다양합니다. 대부분의 기능은 개별 데이터 세트에 독점적이므로 4개에 걸쳐 대상 기능 세트를 사용하여 제안된 ML 모델을 평가합니다. 데이터 세트는 도전적입니다. 또한 클래스의 비율, 즉 양성 및 공격 흐름은 각 데이터 세트에서 매우 다양합니다. UNSW-NB15 및 CSE-CIC-IDS2018 데이터 세트는 무해성 대 공격 비율이 매우 높은 반면 ToN-IoT 및 BoT-IoT 데이터 세트는 주로 실제 네트워크 동작을 나타내지 않는 공격 샘플로 구성됩니다. 또한 UNSW-NB15, BoT-IoT 및 CSE-CIC-IDS2018 데이터 세트의 일부 기능은 원래 네트워크 패킷에서 찾을 수 없지만 총 바이트 수와 같은 다른 기능을 기반으로 통계적으로 계산되는 수작업 기능입니다. 지난 100초 동안 전송되었습니다. 데이터 세트가 제공하는 보안 정보의 이러한 모든 차이점으로 인해 NIDS 데이터 세트에 대한 표준 기능 세트가 설계되었습니다.


3 Benchmarking a Standard Feature Set

고유한 기능 집합으로 구성된 현재 NIDS 데이터 세트가 직면한 앞서 언급한 한계로 인해 본 논문에서는 표준 기능 집합을 제안합니다. 기능 세트는 ML 기반 NIDS를 효율적으로 설계하기 위해 새로운 NIDS 데이터 세트의 릴리스에 사용되도록 평가 및 벤치마킹됩니다. ML 기반 NIDS의 설계에는 구현 시 침입에 대해 추출 및 스캔할 기능 세트가 필요합니다. 이러한 기능을 선택하면 ML 모델 분류를 지원하기 위해 적절한 양의 보안 이벤트를 포함해야 하므로 NIDS의 성능이 크게 변경됩니다. 연구원은 표준 기능 세트를 보유함으로써 여러 데이터 세트에서 선택한 기능을 기반으로 모델의 분류 기능을 평가할 수 있으므로 여러 네트워크 환경에서 수행되는 다양한 공격 시나리오가 가능합니다. 이것은 측정된 모델 성능이 다른 네트워크에 배포될 때 일반화되는지 확인하는 데 사용할 수 있습니다. 또한 공통 기반 기능 세트를 공유하는 데이터세트를 가짐으로써 데이터세트를 병합하여 보편적이고 포괄적인 데이터 소스를 생성할 수 있습니다. 마지막으로 표준 기능 세트를 사용하면 NIDS 데이터 세트에서 제공하는 보안 정보를 제어할 수 있습니다.

우리는 표준 기능 세트가 연구 실험 수와 ML 기반 NIDS의 실제 배포 사이의 격차를 좁힐 것이라고 믿습니다[14].

3.1 NetFlow
네트워크 트래픽의 수집 및 저장은 조직이 네트워크 환경을 모니터링, 분석 및 감사하는 데 중요합니다. 그러나 네트워크 트래픽은 볼륨이 과부하되는 경향이 있으므로 흐름 측면에서 집계됩니다. 네트워크 데이터 흐름은 원본/목적지 IP 주소 및 L4(전송 계층) 포트와 L4 프로토콜과 같은 일부 속성을 공유하는 두 개의 고유한 끝점 사이의 단방향 또는 양방향 패킷 시퀀스입니다. 다섯 튜플 [11]. 각 네트워크 트래픽의 세부 정보를 나타내는 추가 기능을 사용하여 데이터 흐름을 향상시킬 수도 있습니다. 이러한 기능이 제공하는 정보에는 위협 발생 시 네트워크 트래픽 분석에 필수적인 보안 이벤트가 포함되어 있습니다[16].

네트워크 흐름은 NetFlow가 1996년 Cisco의 Darren과 Barry Bruins가 개발하고 제안한 사실상의 산업 표준인 다양한 형식으로 표현될 수 있습니다[17]. NetFlow는 수년에 걸쳐 발전했으며 버전 9는 다양한 데이터 기능과 양방향 흐름 지원으로 인해 가장 일반적입니다[18].

라우터 및 스위치와 같은 대부분의 네트워크 장치는 NetFlow 레코드를 추출할 수 있습니다. 이는 NIDS 데이터 세트에 대한 NetFlow 기능을 표준화하는 데 큰 동기가 됩니다. 이를 수집하고 저장하는 데 필요한 복잡성과 리소스 수준이 낮기 때문입니다. 이 백서에서는 NetFlow v9 기능을 사용하여 표 1에 나열 및 설명된 제안된 기능 집합을 구성했습니다. 총 43개의 기능이 있으며 일부는 일반적인 흐름 통계에 대한 정보를 제공하고 다른 일부는 DNS 및 FTP와 같은 특정 프로토콜 애플리케이션에 대한 정보를 제공합니다. 모든 기능은 흐름 기반입니다. 즉, 패킷 헤더에서 추출되며 개인 정보 보호 문제로 인해 보안 통신에서 종종 암호화되는 페이로드 정보에 의존하지 않습니다. 선택한 기능은 효율적인 ML 실험을 위해 유형이 숫자입니다. 이러한 기능에는 모델의 침입 탐지 기능을 향상시키는 유용한 보안 이벤트가 포함되어 있습니다.

3.2 Datasets
그림 2는 제안된 기능 세트를 사용하여 NIDS 데이터 세트를 생성하는 절차를 보여줍니다. Ntop[19]의 nProbe 도구는 공개적으로 사용 가능한 pcap 파일에서 43개의 NetFlow 버전 9 기능을 추출하는 데 사용됩니다. 출력 형식은 텍스트 흐름으로 선택되며 각 기능은 쉼표(,)로 구분되어 CSV 파일로 활용됩니다. 5개의 흐름 식별자를 일치시켜 두 개의 레이블 기능이 생성됩니다. 소스/대상 IP와 포트 및 프로토콜을 원본 데이터 세트에서 게시한 실측 공격 이벤트에 연결합니다. 데이터 흐름이 공격 이벤트에 있는 경우 이진 레이블에서 공격(클래스 1)으로 레이블이 지정되고 해당 공격 유형이 공격 레이블에 기록됩니다. 그렇지 않으면 샘플에 양성 흐름(클래스 1)으로 레이블이 지정됩니다. 0).
Fig. 2: Feature set extraction and labelling procedure

본 논문에서 제안하는 특징 집합은 잘 알려진 4개의 데이터셋에서 추출되었다. UNSW-NB15, BoT-IoT, ToN-IoT 및 CSE-CIC-IDS2018. 공개적으로 사용 가능한 pcap 파일 및 지상 실측 이벤트는 각각 기능 추출 및 레이블 지정 프로세스에서 활용되었습니다. 생성된 데이터 세트의 이름은 NF-UNSW-NB15-v2, NF-BoT-IoT-v2, NF-ToN-IoT-v2, NF-CSE-CIC-IDS2018-v2 및 NF-UQ-NIDS-v2입니다. 나중의 데이터 세트는 다른 모든 데이터 세트의 병합이며, 이는 공통 기능 세트를 갖는 실질적인 이점입니다. 표 2는 NetFlow 데이터 세트를 나열하고 사용된 기능 추출(FE) 도구, 기능 수, 파일 크기 및 무해한 공격 샘플 비율 측면에서 해당 속성을 원래 데이터 세트와 비교합니다. 그림과 같이 두 개의 NetFlow 데이터 세트는 각각의 원래 NIDS 데이터 세트에 해당하며 여기서 v1 및 v2는 각각 기본 및 확장 버전입니다. 다섯 번째 NetFlow 데이터 세트는 네 가지를 모두 결합한 포괄적인 데이터 세트입니다.

• NF-UNSW-NB15-v2 NF-UNSW-NB15라는 이름의 UNSW-NB15 데이터 세트의 NetFlow 기반 형식은 추가 NetFlow 기능으로 확장되었으며 해당 공격 범주로 레이블이 지정되었습니다. 총 데이터 흐름 수는 2,390,275개이며 그 중 95,053개(3.98%)는 공격 샘플이고 2,295,222개(96.02%)는 양성 샘플입니다. 공격 샘플은 9개의 하위 범주로 더 분류되며, 표 3은 NF-UNSW-NB15-v2 데이터 세트의 모든 흐름 분포를 나타냅니다.

Table 3: NF-UNSW-NB15-v2 distribution

• NF-BoT-IoT-v2 NF-BoT-IoT 데이터셋을 확장하여 IoT NetFlow 기반 데이터셋을 생성한다.

기능은 공개적으로 사용 가능한 pcap 파일에서 추출되었으며 흐름에는 각각의 공격 범주로 레이블이 지정되었습니다. 총 데이터 흐름 수는 37,763,497개이며 그 중 37,628,460개(99.64%)는 공격 샘플이고 135,037개(0.36%)는 양성 샘플입니다. 데이터 세트에는 네 가지 공격 범주가 있으며 표 4는 모든 흐름의 NF-BoT-IoT-v2 분포를 나타냅니다.

• NF-ToN-IoT-v2 ToN-IoT 데이터 세트의 공개적으로 사용 가능한 pcaps는 NetFlow 레코드를 생성하는 데 활용되어 NF-ToN-IoT라는 NetFlow 기반 IoT 네트워크 데이터 세트로 이어집니다. 총 데이터 흐름 수는 16,940,496개이며 그 중 10,841,027개(63.99%)는 공격 샘플이고 6,099,469개(36.01%)는 양성 샘플입니다. 표 5는 NF-ToN-IoT-v2 데이터 세트의 분포를 나열하고 정의합니다.

• NF-CSE-CIC-IDS2018-v2 CSE-CIC-IDS2018 데이터 세트의 원래 pcap 파일은 NF-CSE-CIC-IDS2018-v2라는 NetFlow 기반 데이터 세트를 생성하는 데 사용됩니다. 총 흐름 수는 18,893,708개이며 그 중 2,258,141개(11.95%)는 공격 샘플이고 16,635,567개(88.05%)는 양성 샘플입니다. 표 6은 데이터 세트의 분포를 나타냅니다.


• NF-UQ-NIDS-v2 앞서 언급한 모든 데이터 세트를 병합하는 포괄적인 데이터 세트입니다. 새로 게시된 데이터 세트는 여러 개의 작은 데이터 세트를 병합할 수 있는 공유 데이터 세트 기능 세트의 이점을 나타냅니다. 이것은 결국 여러 네트워크 설정 및 다양한 공격 설정의 흐름을 포함하는 더 크고 보편적인 NIDS 데이터 세트로 이어질 것입니다. 여기에는 각 흐름의 원래 데이터 세트를 식별하는 추가 레이블 기능이 포함됩니다. 이는 둘 이상의 서로 다른 테스트베드 네트워크에서 수행되는 동일한 공격 시나리오를 비교하는 데 사용할 수 있습니다. 모든 상위 범주를 결합하도록 공격 범주가 수정되었습니다. DoS 공격(Hulk), DoS 공격(SlowHTTPTest), DoS 공격(GoldenEye) 및 DoS 공격(Slowloris)이라는 공격 이름이 상위 DoS 범주로 변경되었습니다. DDoS 공격-LOIC-UDP, DDoS 공격-HOIC 및 DDoS 공격-LOIC-HTTP라는 공격 이름이 DDoS로 변경되었습니다. FTP-BruteForce, SSH-Bruteforce, Brute Force -Web 및 Brute Force -XSS라는 이름의 공격이 무차별 대입 범주로 결합되었습니다. 마지막으로 SQL 주입 공격이 주입 공격 범주에 포함되었습니다. NF-UQ-NIDS 데이터 세트에는 총 75,987,976개의 레코드가 있으며 그 중 25,165,295개(33.12%)는 양성 흐름이고 50,822,681개(66.88%)는 공격입니다. 표 7에는 최종 공격 범주의 분포가 나열되어 있습니다.

4 Evaluation

이 섹션에서는 제안된 NetFlow 기능 세트가 5개의 NIDS 데이터 세트에서 평가됩니다. NF-UNSW-NB15-v2, NF-BoT-IoT-v2, NF-ToN-IoT-v2, NF-CSE-CIC-IDS2018-v2 및 NF-UQ-NIDS-v2. 이 목적을 위해 나무 계열에 속하는 Extra Trees로 알려진 앙상블 ML 분류기가 활용되었습니다. 평가는 기본 NetFlow 및 원본 데이터 세트의 해당 메트릭과 분류기 성능을 비교하여 수행됩니다. 정확도, AUC(Area Under the Curve), F1 점수, DR(Detection Rate), FAR(False Alarm Rate) 및 마이크로초(µs) 단위로 단일 테스트 샘플을 예측하는 데 필요한 시간과 같은 다양한 분류 메트릭이 수집됩니다. 데이터 사전 처리의 일부로 ID, 소스/목적지 IP 및 포트, 타임스탬프, 시작/종료 시간과 같은 흐름 식별자가 삭제되어 공격 및 희생 엔드 노드에 대한 학습 편향을 방지합니다. UNSW-NB15 및 NF-UNSW-NB15-v2 데이터 세트의 경우 TTL(Time To Live) 기반 기능은 레이블과의 극단적인 상관 관계로 인해 삭제됩니다. 또한 최소-최대 정규화 기술을 적용하여 모든 데이터 세트의 값을 0과 1 사이로 조정했습니다. 데이터 세트는 교육 및 테스트 목적으로 70%-30%로 분할되었습니다. 공정한 평가를 위해 5번의 교차 검증 분할을 수행하고 평균을 측정합니다.

4.1 Binary-class Classification
표 8에서는 데이터 세트의 공격 탐지(이진 분류) 성능을 측정하고 원본 및 기본 NetFlow 데이터 세트와 비교했습니다. NF-UNSW-NB15-v2 데이터 세트를 사용하면 ML 모델의 성능이 NF-UNSW-NB15 및 UNSW-NB15 데이터 세트를 사용할 때 각각 0.9485 및 0.9545에 비해 0.9845의 AUC로 크게 증가했습니다. 이 모델은 확장된 NetFlow 기능 세트를 사용할 때 가장 짧은 예측 시간에 가장 높은 F1 점수인 0.97을 달성했습니다. NF-BoT-IoT-v2 데이터 세트는 ML 모델이 BoT-IoT 데이터 세트와 동일한 가능한 최고의 탐지 정확도와 F1 점수를 달성할 수 있도록 했습니다. 그러나 이 모델은 FAR과 예측 시간이 상당히 낮아 AUC가 0.9987 증가하고 예측 시간이 3.90 µs로 낮아졌습니다. 확장된 NetFlow 기능 세트를 사용하여 ML 모델은 93.82%에 비해 100%의 NF-BoT-IoT보다 훨씬 더 높은 정확도를 달성했습니다.

NF-ToN-IoT-v2 데이터 세트를 사용하는 ML 모델의 침입 탐지 결과는 원래 ToN-IoT 데이터 세트보다 우수합니다. NF-ToN-IoT와 비교하여 DR은 더 높지만 FAR은 약간 더 높습니다. 전반적으로 NF-ToN-IoT-v2를 사용한 모델이 달성한 정확도는 99.64%로 ToN-IoT(97.86%)보다 높고 NF-ToN-IoT(99.66%)와 유사합니다. NF-CSE-CIC-IDS2018-v2 데이터 세트를 사용할 때 모델 성능은 CSE-CIC-IDS2018 및 NF-CSE-CIC-IDS2018-v2 데이터 세트보다 훨씬 더 효율적입니다. 96.89%의 높은 DR과 0.31%의 낮은 FAR을 달성했으며 샘플 예측당 21.75µs가 필요했습니다. 달성된 전체 정확도는 99.35%로 CSE-CIC-IDS2018(98.31%) 및 NF-CSE-CIC-IDS2018(95.33%) 데이터 세트보다 높습니다. 병합된 NF-UQ-NIDS-v2 데이터 세트는 모델이 97.90%의 정확도, 97.12%의 DR 및 0.52%의 FAR을 달성할 수 있게 하여 14.18µs의 더 낮은 예측 시간으로 NF-UQ-NIDS 데이터 세트를 능가합니다.

Fig. 3: Binary-class classification F1 score
Figure 3 visually represents the F1 score obtained when applying an Extra Trees classifier on the three different feature sets of five NIDS datasets; the original as well as basic and proposed NetFlow feature sets.

NetFlow 기능 세트 간의 이 공정한 비교는 여러 데이터 세트에서 공통 기능 세트를 갖는 이점을 보여줍니다. 공통 기능 세트를 사용하여 다양한 공격 탐지를 평가할 수 있습니다. 전반적으로 제안된(확장된) NetFlow 기능 세트는 공격 탐지 성능 측면에서 원래 및 기본 기능 세트를 능가했습니다. 모든 데이터 세트는 각각의 데이터 세트보다 높거나 유사한 F1 점수를 상당히 달성했습니다. 제안된 기능 세트를 사용하면 안정적인 탐지 성능을 얻을 수 있음이 분명합니다. 추출 작업을 향상시키기 위해 주요 기능을 식별하려면 추가 기능 선택 실험이 필요합니다.

4.2 Multi-class Classification

제안된 NetFlow 기능 세트를 추가로 평가하기 위해 데이터 세트에 있는 각 클래스의 DR, F1 점수 및 예측 시간의 가중 평균을 측정하기 위해 다중 분류 실험이 수행됩니다.

표 9, 10, 11, 12, 13은 NF-UNSW-NB15-v2, NF-BoT-IoT-v2, NF-ToN-IoT-v2, NF-CSE-CIC-IDS201-v2 및 NF- 각각 UQ-NIDS-v2 데이터 세트. 원본 및 기본 NetFlow 기능 세트로 구성된 데이터 세트는 비교 목적으로 제공됩니다. 표 9에서 M1 모델의 F1 점수를 0.98에서 0.99로 높이고 예측 시간을 8.81µs로 줄임으로써 이전 데이터 세트에 비해 NF-UNSW-NB15-v2를 사용하는 이점이 실현됩니다. fuzzer, 일반 및 웜과 같은 특정 공격 유형의 DR은 크게 개선된 반면 나머지는 약간 동일한 비율로 유지되었습니다. 분석, 백도어 및 DoS 공격의 탐지는 확장된 Netflow 기능 세트를 사용할 때 여전히 신뢰할 수 없으며 누락된 주요 기능을 식별하기 위해 추가 분석이 필요합니다. 그러나 샘플 수가 적기 때문에 NF-UNSW-NB15-v2의 전체 정확도는 UNSW-NB15(98.19%) 및 NF-UNSW-NB15(97.62%)보다 높습니다(98.90%).

표 10은 NF-BoT-IoT-v2 데이터 세트를 사용할 때 ML 모델이 100% 정확도 및 1.00 F1 점수의 BoT-IoT 데이터 세트를 사용할 때 얻은 거의 완벽한 다중 분류 성능을 달성하고 있음을 보여줍니다. 83.01%만이 성공적으로 탐지된 도난 공격을 제외하고 4가지 공격 범주는 거의 완벽하게 탐지되었습니다. ML 모델의 정확도는 73.58%에서 99.99%로, F1 점수는 0.77에서 1.00으로 기본 세트에 비해 확장된 NetFlow 기능 세트에 적용했을 때 증가했습니다. 전반적으로 예측 시간이 약간 증가했음에도 불구하고 기본 NetFlow 데이터 세트가 직면한 성능 제한을 극복한 상당한 개선입니다.

표 11에서 NF-ToN-IoT-v2 데이터 세트는 다중 분류 실험을 수행할 때 ML 모델이 뛰어난 결과를 달성할 수 있도록 했습니다. 확장된 NetFlow 기능 세트는 모델의 가중 F1 점수를 각각 0.87 및 0.60에서 0.98로 증가시켜 ToN-IoT 및 NF-ToN-IoT 기능 세트를 모두 능가했습니다. 또한 이 모델은 기본 NetFlow 데이터 세트에 적용할 때보다 더 낮은 예측 시간이 필요합니다. 확장된 Netflow 기능 세트는 DoS, MITM 및 XSS 공격을 제외한 모든 공격 유형의 DR을 높였습니다. 유용한 보안 이벤트가 포함된 기능에 대한 추가 분석은 탐지를 지원하는 데 필수적입니다. 전반적으로 NF-ToN-IoT-v2의 기능 세트는 확장된 NetFlow 기능 세트의 신뢰성을 확인하는 98.05%의 향상된 정확도로 데이터 세트에 존재하는 공격을 탐지하는 ML 모델을 지원했습니다.

표 12는 NF-CSE-CIC-IDS2018-v2 데이터 세트의 탐지 결과를 나타냅니다. ML 모델은 데이터 세트에 있는 대부분의 공격의 DR을 개선하여 96.90%의 정확도와 0.98의 F1 점수를 달성했습니다. 대부분의 공격은 99%~100% 범위의 DR로 완전히 탐지되었습니다. 그러나 Brute Force, DDoS 공격-HOIC, 침투, SQL 주입과 같은 특정 공격 유형의 탐지는 확장된 Netflow 기능 세트를 사용할 때 여전히 신뢰할 수 없습니다. 오 탐지 수가 많기 때문에 각각의 F1 점수가 낮습니다. 전반적으로 ML 모델의 성능은 NF-CSE-CIC-IDS2018-v2 데이터 세트에 적용할 때 CSE-CIC-IDS2018 및 NF-CSE-CIC-IDS2018 데이터 세트를 사용할 때보다 우수합니다. 그러나 예측 시간은 각각 24.17µs 및 17.29µs에 비해 27.28µs 증가했습니다.

표 13은 병합된 NIDS 데이터 세트의 공격 탐지 결과를 비교한 것입니다. NF-UQ-NIDS-v2와 이전(NF-UQ-NIDS) 데이터 세트 비교. 대부분의 공격 DR은 확장된 NetFlow 기능 세트를 사용하여 증가했습니다. DoS, Generic, Worms, DDoS, Injection, 비밀번호, 스캐닝 및 XSS와 같은 공격 탐지가 크게 향상되었습니다. 그러나 침투 및 MITM과 같은 공격은 덜 정확하게 탐지되었습니다. 또한 단일 테스트 샘플을 예측하는 데 소요되는 시간이 14.74µs에서 25.67µs로 증가했습니다. 70.81%에서 96.96%로 향상된 정확도와 0.79에서 0.97로 F1 점수는 여러 네트워크 환경에서 수행된 20가지 공격 유형에 걸쳐 확장된 NetFlow 기능 세트에 적용될 때 향상된 ML 모델 탐지 기능을 확인합니다.

전반적으로 제안된 NetFlow 기능 세트는 그림 4에 표시된 대로 데이터 세트의 다중 클래스 분류 성능을 크게 개선했습니다. F1 점수는 y축에 표시되고 세 가지 기능 세트의 데이터 세트는 x축에 표시됩니다. 탐지 성능은 종종 원래 기능 세트와 비슷하지만 기본 NetFlow 기능 세트보다 월등히 뛰어납니다. 따라서 생성된 데이터 세트는 표준 공통 NetFlow 기능 세트를 채택하고 향상된 탐지 성능을 통해 이점을 누릴 수 있습니다.

이는 향후 NIDS 데이터 세트에서 제안된 기능 세트의 사용에 동기를 부여하고 연구원이 효율적이고 신뢰할 수 있는 ML 실험을 위해 제안된 형식으로 데이터 세트를 생성하도록 권장합니다.


5 Conclusion
이 백서는 표 2에 나열된 NIDS 데이터 세트를 위한 NetFlow 기반 표준 기능 세트를 제안합니다. 표준 기능 세트를 갖는 것의 중요성으로 인해 여러 데이터 세트, 네트워크 환경 및 공격 시나리오에서 ML 기반 NIDS를 안정적으로 평가할 수 있습니다. 또한 표준 기능 세트를 사용하면 여러 NIDS 데이터 세트를 병합할 수 있으므로 레이블이 지정된 데이터 세트가 더 다양해집니다. 제안된 기능 세트 평가의 일부로 기존 NIDS 벤치마크 데이터 세트에서 5개의 새로운 NIDS 데이터 세트가 생성되었습니다. 이러한 새로운 데이터 세트 변형은 연구 커뮤니티에 공개적으로 제공되었습니다. Extra Tree 분류기를 기반으로 한 우리의 평가는 43개의 기능이 포함된 NetFlow 기반 기능 세트가 이진 및 다중에 대해 고려된 모든 벤치마크 NIDS 데이터 세트에 대해 독점 기능 세트보다 더 높은 분류 성능(F1-Score)을 달성하는 것으로 나타났습니다. 클래스 분류 시나리오.

제안된 NetFlow 기반 기능 세트는 효율적인 NetFlow 내보내기 및 수집의 광범위한 가용성으로 인해 매우 실용적이고 확장 가능하다는 추가 이점이 있습니다. NIDS 데이터 세트에 대한 표준 기능 세트를 갖는 주요 이점과 이 백서의 주요 기여는 광범위한 데이터 세트에서 ML 기반 트래픽 분류자를 보다 엄격하고 안정적으로 평가할 수 있는 기능이며 따라서 더 넓은 범위의 공격 유형입니다. , 네트워크 토폴로지 등. 이를 통해 이러한 ML 기반 NIDS가 훈련된 데이터 세트에서 다른 네트워크 시나리오로 일반화할 수 있는 정도를 평가할 수 있습니다. 이러한 철저하고 엄격한 평가를 수행할 수 없기 때문에 실제 네트워크 설정에서 ML 기반 NIDS를 제한적으로 배포하는 이유 중 하나라고 생각합니다. 따라서 우리는 이 백서의 기여가 ML 기반 NIDS에 대한 학술 연구와 실제 배포 간의 격차를 해소하는 단계를 제공할 수 있다고 믿습니다.
